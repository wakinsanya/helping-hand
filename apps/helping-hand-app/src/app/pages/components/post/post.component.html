<div>
  <div class="post__back-btn__wrap">
    <button ghost nbButton shape="round" routerLink="pages/feed">
      <nb-icon icon="chevron-left-outline"></nb-icon>
      Back
    </button>
  </div>
  <nb-card>
    <nb-card-header>
      <h3>{{ post?.title }}</h3>
    </nb-card-header>
    <nb-card-body>
      <div [innerHTML]="post?.text"></div>
      <div class="post-author__wrap">
        <h5>Written By</h5>
        <nb-user
          size="giant"
          [name]="postOwner?.firstName + ' ' + postOwner?.lastName"
          [picture]="postOwner?.pictureUrl"
          [title]="postOwner?.role"
          badgePosition="bottom end"
          badgeStatus="warning"
          [badgeText]="(postOwnerProfile?.metadata?.totalStars || 0) + ' stars'"
        >
        </nb-user>
      </div>
      <div class="post-opts__wrap" *ngIf="loggedInUser?._id !== postOwner?._id">
        <button
          size="small"
          hero
          (click)="
            toggleMetadataByKey(
              isPostStarred ? postActionType.Unstar : postActionType.Star
            )
          "
          nbButton shape="round"
          [status]="isPostStarred ? 'danger' : 'primary'"
        >
          <nb-icon icon="star-outline"> </nb-icon>
          {{ isPostStarred ? 'Unstar' : 'Give A Star' }}
        </button>
        <button
          size="small"
          status="success"
          hero
          (click)="
            toggleMetadataByKey(
              isPostFavorited
                ? postActionType.Unfavorite
                : postActionType.Favorite
            )
          "
          nbButton shape="round"
          [status]="isPostFavorited ? 'danger' : 'primary'"
        >
          <nb-icon icon="heart-outline"> </nb-icon>
          {{ isPostFavorited ? 'Unfavourite' : 'Favourite' }}
        </button>
      </div>
      <h5>Comments</h5>
      <div
        *ngIf="post?.comments?.length === 0"
        class="comment-list__placeholder"
      >
        <span>Be the first one to leave a comment!</span>
      </div>
      <div class="new-comment-input__wrap">
        <input
          fullWidth
          type="text"
          nbInput
          [(ngModel)]="commentBody.text"
          [placeholder]="'Tell ' + postOwner?.firstName + ' what you think!'"
        />
      </div>
      <button
        nbButton shape="round"
        fullWidth
        (click)="postComment()"
        [disabled]="!commentBody.text"
      >
        <nb-icon icon="message-square-outline"></nb-icon>
        Leave Comment
      </button>
      <nb-list>
        <nb-list-item *ngFor="let entry of commentUserList">
          <div>
            <nb-user
              size="giant"
              [name]="entry?.user?.firstName + ' ' + entry?.user?.lastName"
              [picture]="entry?.user?.pictureUrl"
              [title]="entry?.comment?.createdAt | customShortDate"
            >
            </nb-user>
            <div>
              <h6>{{ entry?.comment?.text }}</h6>
            </div>
          </div>
          <div
            class="comment-opts__wrap"
            *ngIf="loggedInUser?._id === entry?.user?._id"
          >
            <button
              nbButton
              ghost shape="round"
              status="basic"
              nbTooltip="Edit your comment"
              nbTooltipStatus="info"
            >
              <nb-icon icon="edit-outline"></nb-icon>
            </button>
            <button
              nbButton
              ghost
              shape="round"
              status="basic"
              nbTooltip="Delete your comment"
              nbTooltipStatus="danger"
              (click)="deleteComment(entry?.comment?._id)"
            >
              <nb-icon icon="trash-2-outline"></nb-icon>
            </button>
          </div>
        </nb-list-item>
      </nb-list>
      <div class="comments-pagin__wrap">
        <button
        size="small"
        nbButton shape="round"
        [disabled]="commentsQuery.skip === 0"
        (click)="onPageNav('prev')"
      >
        <nb-icon icon="chevron-left-outline"></nb-icon>
        Previous Page
      </button>
      <button
        size="small"
        nbButton shape="round"
        (click)="onPageNav('next')"
        [disabled]="currentCommentsPage * commentsQuery.limit >= commentsTotalCount"
      >
        Next Page
        <nb-icon icon="chevron-right-outline"></nb-icon>
      </button>
      </div>
    </nb-card-body>
    <nb-card-footer> </nb-card-footer>
  </nb-card>
</div>
