<nb-layout>
  <nb-layout-column>
    <div class="feed-list__container">
      <div class="feed-list__inner-container">
        <div class="feed-list__new-post__wrap">
          <button
            nbButton
            fullWidth
            (click)="startPostCreation(postCreateTemplate)"
          >
            <nb-icon icon="plus-outline"></nb-icon>Create Post
          </button>
        </div>
        <ng-container
          *ngTemplateOutlet="
            feedDataList?.length || postQuery.skip
              ? postListTemplate
              : noPostListTemplate
          "
        ></ng-container>
        <ng-template #noPostListTemplate>
          <h4 class="feed-list__no-feed-placeholder">No Posts Yet</h4>
        </ng-template>
        <ng-template #postListTemplate>
          <h3>Recent Posts</h3>
          <div
            class="feed-list__post__wrap"
            *ngFor="let entry of feedDataList; let i = index"
            (click)="navigateToPost(i)"
          >
            <nb-card class="feed-list__post-card">
              <nb-card-header>{{ entry?.post?.title }}</nb-card-header>
              <nb-card-body>
                <p>
                  {{ entry?.post?.text }}
                </p>
              </nb-card-body>
              <nb-card-footer>
                <nb-actions size="small" accent="primary" responsive>
                  <nb-action
                    ><nb-user
                      badgePosition="bottom end"
                      badgeStatus="success"
                      [badgeText]="(entry?.ownerProfile?.metadata?.totalStars || 0) + ' stars'"
                      size="large"
                      [name]="
                        entry?.ownerFirstName +
                        ' ' +
                        entry?.ownerLastName
                      "
                      [picture]="entry.ownerPictureUrl"
                    >
                    </nb-user
                  ></nb-action>
                </nb-actions>
              </nb-card-footer>
            </nb-card>
          </div>
        </ng-template>

        <ng-template #postCreateTemplate>
          <nb-card>
            <nb-card-header>
              Create a post
            </nb-card-header>
            <nb-card-body>
              <div class="create-post-form__container">
                <label for="postTitle">Title:</label>
                <input
                  [(ngModel)]="createPostDto.title"
                  name="postTitle"
                  type="text"
                  nbInput
                  fullWidth
                  placeholder="Short title describing what your post is about"
                />
                <label for="description">Text:</label>
                <textarea
                  [(ngModel)]="createPostDto.text"
                  name="description"
                  nbInput
                  fullWidth
                  placeholder="Main body of your post"
                ></textarea>
                <button nbButton outline fullWidth disabled>
                  <nb-icon icon="attach-outline"></nb-icon>
                  Add A Picture (coming soon)
                </button>
                <button nbButton fullWidth (click)="createPost()">
                  Post
                </button>
              </div>
            </nb-card-body>
          </nb-card>
        </ng-template>
      </div>
    </div>
  </nb-layout-column>
</nb-layout>
